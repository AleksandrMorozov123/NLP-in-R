{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/aleksandrmorozov123/machine-learning-for-nlp-in-r?scriptVersionId=123457664\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"f43c2e01","metadata":{"_execution_state":"idle","_uuid":"051d70d956493feee0c6d64651c6a088724dca2a","execution":{"iopub.execute_input":"2023-03-26T12:37:18.833732Z","iopub.status.busy":"2023-03-26T12:37:18.831008Z","iopub.status.idle":"2023-03-26T12:37:20.455813Z","shell.execute_reply":"2023-03-26T12:37:20.453324Z"},"papermill":{"duration":1.635085,"end_time":"2023-03-26T12:37:20.459347","exception":false,"start_time":"2023-03-26T12:37:18.824262","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["── \u001b[1mAttaching packages\u001b[22m ─────────────────────────────────────── tidyverse 1.3.2 ──\n","\u001b[32m✔\u001b[39m \u001b[34mggplot2\u001b[39m 3.4.0      \u001b[32m✔\u001b[39m \u001b[34mpurrr  \u001b[39m 1.0.1 \n","\u001b[32m✔\u001b[39m \u001b[34mtibble \u001b[39m 3.1.8      \u001b[32m✔\u001b[39m \u001b[34mdplyr  \u001b[39m 1.0.10\n","\u001b[32m✔\u001b[39m \u001b[34mtidyr  \u001b[39m 1.2.1      \u001b[32m✔\u001b[39m \u001b[34mstringr\u001b[39m 1.5.0 \n","\u001b[32m✔\u001b[39m \u001b[34mreadr  \u001b[39m 2.1.3      \u001b[32m✔\u001b[39m \u001b[34mforcats\u001b[39m 0.5.2 \n","── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n"]},{"data":{"text/html":["'fake-and-real-news-dataset'"],"text/latex":["'fake-and-real-news-dataset'"],"text/markdown":["'fake-and-real-news-dataset'"],"text/plain":["[1] \"fake-and-real-news-dataset\""]},"metadata":{},"output_type":"display_data"}],"source":["# This R environment comes with many helpful analytics packages installed\n","# It is defined by the kaggle/rstats Docker image: https://github.com/kaggle/docker-rstats\n","# For example, here's a helpful package to load\n","\n","library(tidyverse) # metapackage of all tidyverse packages\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","list.files(path = \"../input\")\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"markdown","id":"78ae2fc6","metadata":{"papermill":{"duration":0.003024,"end_time":"2023-03-26T12:37:20.466227","exception":false,"start_time":"2023-03-26T12:37:20.463203","status":"completed"},"tags":[]},"source":["***Natural language processing in R***"]},{"cell_type":"code","execution_count":2,"id":"8de8d206","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:20.505581Z","iopub.status.busy":"2023-03-26T12:37:20.474469Z","iopub.status.idle":"2023-03-26T12:37:23.353803Z","shell.execute_reply":"2023-03-26T12:37:23.352051Z"},"papermill":{"duration":2.887143,"end_time":"2023-03-26T12:37:23.356474","exception":false,"start_time":"2023-03-26T12:37:20.469331","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["    title               text             subject              date          \n"," Length:23481       Length:23481       Length:23481       Length:23481      \n"," Class :character   Class :character   Class :character   Class :character  \n"," Mode  :character   Mode  :character   Mode  :character   Mode  :character  "]},"metadata":{},"output_type":"display_data"}],"source":["# download the required library\n","library (tidyverse)\n","library (tokenizers)\n","library (tidytext)\n","\n","# download the dataset\n","news <- read_csv (\"/kaggle/input/fake-and-real-news-dataset/Fake.csv\", show_col_types = 'FALSE')\n","summary (news)"]},{"cell_type":"code","execution_count":3,"id":"e4f162ff","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:23.366747Z","iopub.status.busy":"2023-03-26T12:37:23.365134Z","iopub.status.idle":"2023-03-26T12:37:23.396788Z","shell.execute_reply":"2023-03-26T12:37:23.395116Z"},"papermill":{"duration":0.039268,"end_time":"2023-03-26T12:37:23.399205","exception":false,"start_time":"2023-03-26T12:37:23.359937","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["    title               text             subject               date      \n"," Length:23481       Length:23481       Length:23481       Min.   :NA     \n"," Class :character   Class :character   Class :character   1st Qu.:NA     \n"," Mode  :character   Mode  :character   Mode  :character   Median :NA     \n","                                                          Mean   :NA     \n","                                                          3rd Qu.:NA     \n","                                                          Max.   :NA     \n","                                                          NA's   :23481  "]},"metadata":{},"output_type":"display_data"}],"source":["# convert the date in data format\n","library(base)\n","news$date <- as.Date(news$date, \"%d%b%Y\")\n","summary (news)"]},{"cell_type":"markdown","id":"e4113fec","metadata":{"papermill":{"duration":0.003327,"end_time":"2023-03-26T12:37:23.405981","exception":false,"start_time":"2023-03-26T12:37:23.402654","status":"completed"},"tags":[]},"source":["***Build the classification model***"]},{"cell_type":"code","execution_count":4,"id":"927d4040","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:23.416032Z","iopub.status.busy":"2023-03-26T12:37:23.414499Z","iopub.status.idle":"2023-03-26T12:37:23.456667Z","shell.execute_reply":"2023-03-26T12:37:23.454275Z"},"papermill":{"duration":0.050522,"end_time":"2023-03-26T12:37:23.459853","exception":false,"start_time":"2023-03-26T12:37:23.409331","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Rows: 23,481\n","Columns: 4\n","$ title   \u001b[3m\u001b[90m<chr>\u001b[39m\u001b[23m \"Donald Trump Sends Out Embarrassing New Year’s Eve Message; T…\n","$ text    \u001b[3m\u001b[90m<chr>\u001b[39m\u001b[23m \"Donald Trump just couldn t wish all Americans a Happy New Yea…\n","$ subject \u001b[3m\u001b[90m<chr>\u001b[39m\u001b[23m \"News\", \"News\", \"News\", \"News\", \"News\", \"News\", \"News\", \"News\"…\n","$ date    \u001b[3m\u001b[90m<date>\u001b[39m\u001b[23m NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n"]}],"source":["glimpse (news)"]},{"cell_type":"code","execution_count":5,"id":"308c432a","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:23.469921Z","iopub.status.busy":"2023-03-26T12:37:23.468447Z","iopub.status.idle":"2023-03-26T12:37:23.486744Z","shell.execute_reply":"2023-03-26T12:37:23.484992Z"},"papermill":{"duration":0.025869,"end_time":"2023-03-26T12:37:23.48921","exception":false,"start_time":"2023-03-26T12:37:23.463341","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style>\n",".list-inline {list-style: none; margin:0; padding: 0}\n",".list-inline>li {display: inline-block}\n",".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n","</style>\n","<ol class=list-inline><li>'Donald Trump Sends Out Embarrassing New Year’s Eve Message; This is Disturbing'</li><li>'Drunk Bragging Trump Staffer Started Russian Collusion Investigation'</li><li>'Sheriff David Clarke Becomes An Internet Joke For Threatening To Poke People ‘In The Eye’'</li><li>'Trump Is So Obsessed He Even Has Obama’s Name Coded Into His Website (IMAGES)'</li><li>'Pope Francis Just Called Out Donald Trump During His Christmas Speech'</li><li>'Racist Alabama Cops Brutalize Black Boy While He Is In Handcuffs (GRAPHIC IMAGES)'</li></ol>\n"],"text/latex":["\\begin{enumerate*}\n","\\item 'Donald Trump Sends Out Embarrassing New Year’s Eve Message; This is Disturbing'\n","\\item 'Drunk Bragging Trump Staffer Started Russian Collusion Investigation'\n","\\item 'Sheriff David Clarke Becomes An Internet Joke For Threatening To Poke People ‘In The Eye’'\n","\\item 'Trump Is So Obsessed He Even Has Obama’s Name Coded Into His Website (IMAGES)'\n","\\item 'Pope Francis Just Called Out Donald Trump During His Christmas Speech'\n","\\item 'Racist Alabama Cops Brutalize Black Boy While He Is In Handcuffs (GRAPHIC IMAGES)'\n","\\end{enumerate*}\n"],"text/markdown":["1. 'Donald Trump Sends Out Embarrassing New Year’s Eve Message; This is Disturbing'\n","2. 'Drunk Bragging Trump Staffer Started Russian Collusion Investigation'\n","3. 'Sheriff David Clarke Becomes An Internet Joke For Threatening To Poke People ‘In The Eye’'\n","4. 'Trump Is So Obsessed He Even Has Obama’s Name Coded Into His Website (IMAGES)'\n","5. 'Pope Francis Just Called Out Donald Trump During His Christmas Speech'\n","6. 'Racist Alabama Cops Brutalize Black Boy While He Is In Handcuffs (GRAPHIC IMAGES)'\n","\n","\n"],"text/plain":["[1] \"Donald Trump Sends Out Embarrassing New Year’s Eve Message; This is Disturbing\"           \n","[2] \"Drunk Bragging Trump Staffer Started Russian Collusion Investigation\"                     \n","[3] \"Sheriff David Clarke Becomes An Internet Joke For Threatening To Poke People ‘In The Eye’\"\n","[4] \"Trump Is So Obsessed He Even Has Obama’s Name Coded Into His Website (IMAGES)\"            \n","[5] \"Pope Francis Just Called Out Donald Trump During His Christmas Speech\"                    \n","[6] \"Racist Alabama Cops Brutalize Black Boy While He Is In Handcuffs (GRAPHIC IMAGES)\"        "]},"metadata":{},"output_type":"display_data"}],"source":["# look at data\n","head (news$title)"]},{"cell_type":"code","execution_count":6,"id":"1e0b11e9","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:23.49997Z","iopub.status.busy":"2023-03-26T12:37:23.498256Z","iopub.status.idle":"2023-03-26T12:37:25.426658Z","shell.execute_reply":"2023-03-26T12:37:25.424879Z"},"papermill":{"duration":1.936607,"end_time":"2023-03-26T12:37:25.429477","exception":false,"start_time":"2023-03-26T12:37:23.49287","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["── \u001b[1mAttaching packages\u001b[22m ────────────────────────────────────── tidymodels 1.0.0 ──\n","\n","\u001b[32m✔\u001b[39m \u001b[34mbroom       \u001b[39m 1.0.2     \u001b[32m✔\u001b[39m \u001b[34mrsample     \u001b[39m 1.1.1\n","\u001b[32m✔\u001b[39m \u001b[34mdials       \u001b[39m 1.1.0     \u001b[32m✔\u001b[39m \u001b[34mtune        \u001b[39m 1.0.1\n","\u001b[32m✔\u001b[39m \u001b[34minfer       \u001b[39m 1.0.4     \u001b[32m✔\u001b[39m \u001b[34mworkflows   \u001b[39m 1.1.2\n","\u001b[32m✔\u001b[39m \u001b[34mmodeldata   \u001b[39m 1.0.1     \u001b[32m✔\u001b[39m \u001b[34mworkflowsets\u001b[39m 1.0.0\n","\u001b[32m✔\u001b[39m \u001b[34mparsnip     \u001b[39m 1.0.3     \u001b[32m✔\u001b[39m \u001b[34myardstick   \u001b[39m 1.1.0\n","\u001b[32m✔\u001b[39m \u001b[34mrecipes     \u001b[39m 1.0.4     \n","\n","── \u001b[1mConflicts\u001b[22m ───────────────────────────────────────── tidymodels_conflicts() ──\n","\u001b[31m✖\u001b[39m \u001b[34mscales\u001b[39m::\u001b[32mdiscard()\u001b[39m masks \u001b[34mpurrr\u001b[39m::discard()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m   masks \u001b[34mstats\u001b[39m::filter()\n","\u001b[31m✖\u001b[39m \u001b[34mrecipes\u001b[39m::\u001b[32mfixed()\u001b[39m  masks \u001b[34mstringr\u001b[39m::fixed()\n","\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m      masks \u001b[34mstats\u001b[39m::lag()\n","\u001b[31m✖\u001b[39m \u001b[34myardstick\u001b[39m::\u001b[32mspec()\u001b[39m masks \u001b[34mreadr\u001b[39m::spec()\n","\u001b[31m✖\u001b[39m \u001b[34mrecipes\u001b[39m::\u001b[32mstep()\u001b[39m   masks \u001b[34mstats\u001b[39m::step()\n","\u001b[34m•\u001b[39m Use \u001b[32mtidymodels_prefer()\u001b[39m to resolve common conflicts.\n","\n"]}],"source":["# split the data into train and test datasets\n","library (tidymodels)\n","set.seed (1234)\n","\n","news_split <- initial_split (news, prop = .7)\n","news_train <- training (news_split)\n","news_test <- testing (news_split)"]},{"cell_type":"code","execution_count":7,"id":"5ecb6f09","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:25.440696Z","iopub.status.busy":"2023-03-26T12:37:25.439146Z","iopub.status.idle":"2023-03-26T12:37:25.456948Z","shell.execute_reply":"2023-03-26T12:37:25.455263Z"},"papermill":{"duration":0.025878,"end_time":"2023-03-26T12:37:25.459343","exception":false,"start_time":"2023-03-26T12:37:25.433465","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style>\n",".list-inline {list-style: none; margin:0; padding: 0}\n",".list-inline>li {display: inline-block}\n",".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n","</style>\n","<ol class=list-inline><li>16436</li><li>4</li></ol>\n"],"text/latex":["\\begin{enumerate*}\n","\\item 16436\n","\\item 4\n","\\end{enumerate*}\n"],"text/markdown":["1. 16436\n","2. 4\n","\n","\n"],"text/plain":["[1] 16436     4"]},"metadata":{},"output_type":"display_data"}],"source":["dim (news_train)"]},{"cell_type":"code","execution_count":8,"id":"d5cd70bd","metadata":{"execution":{"iopub.execute_input":"2023-03-26T12:37:25.470648Z","iopub.status.busy":"2023-03-26T12:37:25.469126Z","iopub.status.idle":"2023-03-26T12:37:25.486665Z","shell.execute_reply":"2023-03-26T12:37:25.484992Z"},"papermill":{"duration":0.025752,"end_time":"2023-03-26T12:37:25.489114","exception":false,"start_time":"2023-03-26T12:37:25.463362","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style>\n",".list-inline {list-style: none; margin:0; padding: 0}\n",".list-inline>li {display: inline-block}\n",".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n","</style>\n","<ol class=list-inline><li>7045</li><li>4</li></ol>\n"],"text/latex":["\\begin{enumerate*}\n","\\item 7045\n","\\item 4\n","\\end{enumerate*}\n"],"text/markdown":["1. 7045\n","2. 4\n","\n","\n"],"text/plain":["[1] 7045    4"]},"metadata":{},"output_type":"display_data"}],"source":["dim (news_test)"]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":10.668723,"end_time":"2023-03-26T12:37:25.615764","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2023-03-26T12:37:14.947041","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}